# Cytosense to EcoTaxa Pipeline

<img src="https://github.com/ecotaxa/cytosense_to_ecotaxa_pipeline/actions/workflows/build.yml/badge.svg" alt="Build cytosense_to_ecotaxa_pipeline"/>


A pipeline tool to convert Cytosense data files to EcoTaxa compatible format.
## Features

- Automated conversion from Cytosense (.cyz) to EcoTaxa format
- Built-in cyz2json binary for data extraction
- Cross-platform support (Linux, Windows, MacOS)

# pre installation
## Linux
sudo apt  install jq 

## Installation

### Installation from Github

just need install.sh file from the repository

```bash
sudo ./install.sh --github
```

### Installation from local files
need to install cyz2json in the repo before, there are some bugs
```bash
sudo ./install.sh
```

on Windows use install.ps1 instead of install.sh not tested



### On MacOSX
When you use manual build: you need to bypass security 
You have 2 possibilities :
using xattr command.
```
xattr -d com.apple.quarantine  /opt/cytosense_to_ecotaxa_pipeline/bin/*
```
or if you do not want use xattr you need to go in Systems Settings > Security & Privacy > General and allow the app to be opened for the 10+ libraries. You need to relauch sevaral time the cyz2json binary to acheive all neccessary permissions.


# Run the pipeline

```bash
/usr/local/bin/cytosense_to_ecotaxa_pipeline Deployment\ 1\ 2024-07-18\ 21h12.cyz 
--extra extra_data.json
```
the result will be in the the folder where you run the command
you will find
+ the json file (generated by cyz2json)
+ the images folder (with ecotaxa tsv file in it)
+ and the zip file, you could upload it to EcoTaxa

# run only main.py
```
(venv) python Deployment\ 1\ 2024-07-18\ 21h12.json --extra extra_data.json
```

# Uninstall

```bash
sudo ./uninstall.sh
```

on Windows use uninstall.ps1 instead of uninstall.sh


# Build


## with GitHub Actions
Commit your code and push it to GitHub.
then add a tag to the commit and push it to GitHub. like the sample below
```bash
git tag v0.0.65 && git push origin v0.0.65
```
the action will build the binary and push it to the release

You will find result in : https://github.com/ecotaxa/cytosense_to_ecotaxa_pipeline/actions
and release in : https://github.com/ecotaxa/cytosense_to_ecotaxa_pipeline/releases

# Bug

+ during install, need to find the version of Python used in the venv
need to make the links to the cyz2json binary and the python scripts

+ extra_data.json : not other name allowed

